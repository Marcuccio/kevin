<!doctype html>
<html lang="en">
    <head>
        <title>CISA</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

        </script>
    </head>
    <body>
        <div class="container">
        <h1>CISA CVE</h1>
        <p>CISA will update this catalog with additional exploited vulnerabilities as they become known, subject to an executive level CISA review and when they satisfy the following thresholds:</p>

        <ul>
            <li>The vulnerability has an assigned Common Vulnerabilities and Exposures (CVE) ID.</li>
            <li>There is reliable evidence that the vulnerability has been actively exploited in the wild.</li>
            <li>There is a clear remediation action for the vulnerability, such as a vendor provided update.</li>
        </ul>


          <!--     
          CVE-2021-27104
          CVE-2021-27102 
        -->
          <textarea id='cvelist' 
              name="textarea" 
              style="width:250px;height:150px;" placeholder="CVE-2021-27104
CVE-2021-27102"></textarea>
          
          <div>
              <button class="btn btn-primary" onclick="check_cve()">Check CVE</button>
              <button class="btn btn-primary" onclick="copyAsJsonToClipboard()">Copy as JSON</button>
          </div>


        <div id="bin-table-wrapper">
            <table id="bin-table">
                <thead>
                    <tr>
                        <th>CVE</th>
                        <th>Vulnerability name</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        </div>

        <script type="text/javascript">
            let _clipboard = [];
            let catalog, catalog_version, catalog_date_released, catalog_count = undefined
            
            fetch("known_exploited_vulnerabilities.json")
              .then(response => catalog=response.json())
              .then(json => {
                  catalog=json
                  catalog_version = catalog.catalog_version
                  catalog_date_released = catalog.catalog_date_released
                  catalog_count = catalog.count
                });

            function copyAsJsonToClipboard() {
                let json_object = JSON.stringify(_clipboard, undefined, 2)
                let dummy = document.createElement("textarea");
                document.body.appendChild(dummy);
                dummy.value = json_object;
                dummy.select();
                document.execCommand("copy");
                document.body.removeChild(dummy);
            }

            function check_cve() {
                cve_list = new Set(document.getElementById('cvelist').value.split('\n').map(el => el.trim()))
                table = document.getElementById('bin-table')

                while(table.rows.length > 1) {
                  table.deleteRow(1);
                }

                catalog.vulnerabilities.map(entry => {
                    if (cve_list.has(entry.cveID)) {
                        row = table.insertRow()
                        row.insertCell().innerHTML = entry.cveID
                        row.insertCell().innerHTML = entry.vulnerabilityName
                        _clipboard.push(entry)
                    }
                })
            }
        </script>
    </body>
</html>