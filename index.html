<!doctype html>
<html lang="en">
    <head>
        <title>CISA</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
        <h1>Verify Known Exploited Vulnerabilities Catalog</h1>

        <p>As you may already know there exists a curated list of actively exploited vulnerabilities curated by the Cybersecurity & Infrastructure Security Agency (CISA)</p>
        <p>CISA will update this catalog with additional exploited vulnerabilities as they become known, subject to an executive level CISA review and when they satisfy the following thresholds:</p>

        <ul>
            <li>The vulnerability has an assigned Common Vulnerabilities and Exposures (CVE) ID.</li>
            <li>There is reliable evidence that the vulnerability has been actively exploited in the wild.</li>
            <li>There is a clear remediation action for the vulnerability, such as a vendor provided update.</li>
        </ul>

        <q>wish there was an easier way to read these. I need to know what they added and if the solution is fixed by a particular patch.</q> 

        <p>You can use this tool to easily verify wether some of you CVE are marked as dangerous!</p>

          <!--     
          CVE-2021-27104
          CVE-2021-27102 
        -->
        <div class="container">
            <div class="row">
                <div class="col col-4">
                    <div class="container">
                        <textarea id='cvelist' name="textarea" class="form-control" required
                            style="max-width:250px;height:150px;" placeholder="CVE-2021-27104&#13;&#10;CVE-2021-27102&#13;&#10;..."></textarea>
                        
                        <div class="mt-3">
                            <button id="checkcve" class="btn btn-primary">Check CVE</button>
                            <button id="copyjson" class="btn btn-primary">Copy table as JSON</button>
                        </div>                        
                        
                    </div>
                </div>

                <div class="col-8">
                    <table id="bin-table" class="table table-hover">
                        <thead>
                            <tr>
                                <th>CVE</th>
                                <th>Vulnerability name</th>
                                <th>Short Description</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

            </div>
        </div>

        <script type="text/javascript">
        (function () {
        'use strict'

            let _clipboard = [];
            let catalog, catalog_version, catalog_date_released, catalog_count = undefined
           
            fetch('known_exploited_vulnerabilities.json')
                .then(response => catalog=response.json())
                .then(json => {
                    catalog               = json
                    catalog_version       = catalog.catalog_version
                    catalog_date_released = catalog.catalog_date_released
                    catalog_count         = catalog.count
                });

            function copyAsJsonToClipboard() {
                let json_object = JSON.stringify(_clipboard, undefined, 2)
                let dummy = document.createElement('textarea');
                document.body.appendChild(dummy);
                dummy.value = json_object;
                dummy.select();
                document.execCommand('copy');
                document.body.removeChild(dummy);
            }
            document.getElementById('checkcve').addEventListener('click', check_cve);

            function check_cve() {
                // empty the clipboard every time
                _clipboard = [];
                
                let cve_list = new Set(document.getElementById('cvelist').value.split('\n').map(el => el.trim()))

                let table = document.getElementById('bin-table')

                while(table.rows.length > 1) {
                  table.deleteRow(1);
                }

                catalog.vulnerabilities.map(entry => {
                    if (cve_list.has(entry.cveID)) {
                        let row = table.insertRow()
                        row.insertCell().innerHTML = entry.cveID
                        row.insertCell().innerHTML = entry.vulnerabilityName
                        row.insertCell().innerHTML = entry.shortDescription
                        _clipboard.push(entry)
                    }
                })
            }          
            document.getElementById('copyjson').addEventListener('click', copyAsJsonToClipboard);

        })()
        </script>
    </body>
</html>